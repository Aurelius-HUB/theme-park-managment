<style>
	.navbar {
	background-color: #343a40;
	padding: 0 20px; /* Remove vertical padding */
	display: flex;
	justify-content: space-between;
	align-items: center;
	color: white;
	margin-bottom: 1em;
	/* Add margin below the navbar */
	min-height: 50px; /* Set a fixed height */
	}
	.nav-links {
	display: flex;
	height: 100%;
	}
	.nav-links a, .dropdown .dropbtn {
	color: #f8f9fa;
	text-decoration: none;
	padding: 15px 12px; /* Standard padding for all links */
	transition: background-color 0.2s;
	margin-right: 5px; /* Spacing between links */
	display: flex; /* Use flex to align text */
	align-items: center;
	/* Center text vertically */
	height: 100%; /* Make link fill the nav height */
	box-sizing: border-box;
	/* Include padding in height */
	background-color: transparent;
	border: none;
	font-family: inherit;
	font-size: inherit;
	cursor: pointer;
	}
	.nav-links a:hover, .dropdown:hover .dropbtn {
	background-color: #495057;
	}
	.user-info {
	font-weight: bold;
	}
	.user-info a {
	color: #dc3545;
	font-weight: bold;
	margin-left: 20px;
	text-decoration: none;
	}
	.user-info a:hover {
	text-decoration: underline;
	}

	/* --- Dropdown Styles --- */
	.dropdown {
	position: relative;
	display: inline-block;
	height: 100%;
	}
	.dropdown .dropbtn {
	font-weight: normal;
	/* Match normal link weight */
	}
	.dropdown-content {
	display: none;
	position: absolute;
	background-color: #f9f9f9;
	min-width: 200px;
	box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
	z-index: 1000;
	border-radius: 0 0 4px 4px;
	}
	.dropdown-content a {
	color: black;
	padding: 12px 16px;
	text-decoration: none;
	display: block;
	height: auto;
	/* Override nav-link height */
	line-height: 1.5; /* Normal line height */
	}
	.dropdown-content a:hover {
	background-color: #f1f1f1;
	}
	.dropdown:hover .dropdown-content {
	display: block;
	}
	/* Style for special links */
	.special-link {
	color: #dc3545 !important;
	font-weight: bold;
	}
</style>

<%# The user object is passed to every view from app.js via res.locals %>
<% if (user) { %>
<nav class="navbar">
	<div class="nav-links">
		<a href="/dashboard">Dashboard</a>

		<%# --- Rides Link --- %>
		<% if (user.role === 'Admin' || user.role === 'Park Manager' || user.role === 'Location Manager' || user.role === 'Maintenance' || user.role === 'Staff') { %>
		<a href="/rides">Rides</a>
		<% } %>

		<%# --- HR Dropdown --- %>
		<% if (user.role === 'Admin' || user.role === 'Head of HR' || user.role === 'HR Staff' || user.role === 'Park Manager' || user.role === 'Location Manager') { %>
		<div class="dropdown">
			<button class="dropbtn">HR ▼</button>
			<div class="dropdown-content">
				<a href="/users">Employees</a>
				<% if (user.role === 'Admin' || user.role === 'Head of HR' 
|| user.role === 'HR Staff') { %>
				<a href="/employees/pending" class="special-link">Pending Hires</a>
				<% } %>
				<%# MODIFIED: Added Location Manager for inventory approvals %>
				<% if (user.role === 'Admin' || user.role === 'Head of HR' || user.role === 'Park Manager' || user.role === 'Location Manager') { %>
				<a href="/approvals" class="special-link">Pending Requests</a>
				<% } %>
			</div>
		</div>
		<% } %>

		<%# --- Management Dropdown --- %>
		<% if (user.role === 'Admin' ||
user.role === 'Park Manager' || user.role === 'Location Manager') { %>
		<div class="dropdown">
			<button class="dropbtn">Management ▼</button>
			<div class="dropdown-content">
				<% if (user.role === 'Admin' || user.role === 'Park Manager') { %>
				<a href="/locations">Locations</a>
				<% } %>
				<a href="/vendors">Vendors</a>
				<% if (user.role === 'Admin' || user.role === 'Park Manager') { %>
				<a href="/promotions">Promotions</a>
				<a href="/weather">Weather</a>
				<% } %>
			</div>
		</div>
		<% } %>

		<%# --- MODIFIED: Retail Dropdown (Removed Vendor Manager, Added Staff) --- %>
		<% if (user.role === 'Admin' || user.role === 'Park Manager' || user.role === 'Location Manager' || user.role === 'Staff') { %>
		<div class="dropdown">
			<button class="dropbtn">Retail ▼</button>
			<div class="dropdown-content">
				<%# MODIFIED: Staff cannot see master item list %>
				<% if (user.role === 'Admin' || user.role === 'Park Manager' || user.role === 'Location Manager') { %>
				<a href="/items">Items</a>
				<% } %>
				<a href="/inventory">Inventory</a>
			</div>
		</div>
		<% } %>

		<%# --- Guests Dropdown --- %>
		<% if (user.role === 'Admin' || user.role === 'Park Manager' || user.role === 'Staff') { 
%>
		<div class="dropdown">
			<button class="dropbtn">Guests ▼</button>
			<div class="dropdown-content">
				<a href="/visits/new">Log Park Entry</a>
				<a href="/members">Manage Members</a>
				<% if (user.role === 'Admin' ||
user.role === 'Park Manager') { %>
				<a href="/memberships/types">Membership Types</a>
				<a href="/ticket-types">Ticket Types</a>
				<% } %>
			</div>
		</div>
		<% } %>

		<%# --- Reports Dropdown --- %>
		<% if (user.role === 'Admin' || user.role === 'Park Manager') { %>
		<div class="dropdown">
			<button class="dropbtn">Reports ▼</button>
			<div class="dropdown-content">
				<a href="/reports/attendance">Attendance Report</a>
			</div>
		</div>
		<% } %>
	</div>

	<%# --- User Info (Right Side) --- %>
	<div class="user-info">
		<span>
			Welcome, <%= user.firstName %> (<%= user.role %>)
		</span>
		<a href="/change-password" style="color: #ffc107;">Change Password</a>
		<a href="/logout">Logout</a>
	</div>
</nav>
<% } else { %>
<nav class="navbar">
	<div class="nav-links">
		<a href="/login">Login</a>
	</div>
</nav>
<% } %>